---
import { heroStats } from '../config/heroStats.ts';
import StatsCounter from './StatsCounter.astro';
import { assets } from '../config/assets.ts';
import ImageContainer from './ImageContainer.astro';

const compactStats = heroStats
  .filter((stat) => stat.label !== 'Tech Domains')
  .map((stat) =>
    stat.label === 'Hands-On Learning'
      ? { ...stat, label: 'Hands-On' }
      : stat
  );
---

<section id="home" class="relative flex flex-col overflow-hidden pt-16 md:pt-20 bg-gradient-to-b from-dark-blue via-dark-blue-light to-dark-blue">
  <!-- Row 1: Hero Image -->
  <div class="relative w-full flex-shrink-0">
    <ImageContainer
      src={assets.backgrounds.heroFallback.src}
      alt={assets.backgrounds.heroFallback.alt || 'Tinkerz Space Maker Space'}
      containerClass="w-full"
      maxHeight="max-h-[50vh] sm:max-h-[60vh] md:max-h-none"
      preferredAspectRatio="auto"
    />
  </div>
  
  <!-- Row 2: Stats & CTA Buttons -->
  <div class="relative z-10 container-max px-4 md:px-8 lg:px-16 py-6 md:py-8 lg:py-12 text-center flex flex-col">
    <div class="fade-in max-w-5xl mx-auto w-full flex flex-col gap-6 md:gap-8 lg:gap-10">
      <!-- Stats Bar -->
      <div class="hidden lg:flex flex-col sm:flex-row gap-4 sm:gap-6 md:gap-8 justify-center items-center px-4 w-full">
        {heroStats.map((stat, index) => (
          <div class={`flex-1 max-w-[200px] w-full sm:w-auto ${index < heroStats.length - 1 ? 'sm:border-r sm:border-cyan/20 sm:pr-8' : ''}`}>
            <StatsCounter
              value={stat.value}
              suffix={stat.suffix}
              label={stat.label}
            />
          </div>
        ))}
      </div>
      <div class="grid grid-cols-3 gap-1 sm:hidden justify-center items-center px-4 w-full">
        {compactStats.map((stat) => (
          <div class="w-full">
            <StatsCounter
              value={stat.value}
              suffix={stat.suffix}
              label={stat.label}
              labelClass="text-[10px]"
              valueClass="text-2xl"
            />
          </div>
        ))}
      </div>
      <div class="hidden sm:flex lg:hidden flex-row gap-5 justify-center items-center px-4 w-full">
        {compactStats.map((stat, index) => (
          <div class={`flex-1 max-w-[180px] w-full sm:w-auto ${index < compactStats.length - 1 ? 'sm:border-r sm:border-cyan/20 sm:pr-6' : ''}`}>
            <StatsCounter
              value={stat.value}
              suffix={stat.suffix}
              label={stat.label}
              labelClass="text-xs"
            />
          </div>
        ))}
      </div>
      
      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center items-center">
        <a 
          href="#contact" 
          class="group px-5 py-2.5 sm:px-7 sm:py-3.5 lg:px-8 lg:py-4 bg-cyan text-dark-blue text-sm sm:text-base font-bold rounded-lg hover:bg-cyan-light transition-all transform hover:scale-105 shadow-lg shadow-cyan/30 flex items-center gap-2"
        >
          <svg class="w-4 h-4 sm:w-5 sm:h-5 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
          </svg>
          Get Started
        </a>
        <a 
          href="#about" 
          class="group px-5 py-2.5 sm:px-7 sm:py-3.5 lg:px-8 lg:py-4 border-2 border-cyan text-cyan text-sm sm:text-base font-bold rounded-lg hover:bg-cyan/10 transition-all flex items-center gap-2"
        >
          <svg class="w-4 h-4 sm:w-5 sm:h-5 transition-transform group-hover:rotate-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
          Learn More
        </a>
      </div>
      <!-- Scroll Indicator -->
      <div class="flex justify-center">
        <svg class="w-6 h-6 text-cyan animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
        </svg>
      </div>
    </div>
  </div>
</section>

<script>
  // Fade in animation on load
  document.addEventListener('DOMContentLoaded', () => {
    const fadeElements = document.querySelectorAll('.fade-in');
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });

    fadeElements.forEach(el => observer.observe(el));
    
    // Trigger immediately for hero
    const heroFade = document.querySelector('#home .fade-in');
    if (heroFade) {
      setTimeout(() => heroFade.classList.add('visible'), 100);
    }
  });
</script>

